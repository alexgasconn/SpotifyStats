<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spotify Stats - Advanced Analyzer</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script
        src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/wordcloud2.js/1.1.1/wordcloud2.min.js"></script>
</head>

<body>
    <div class="container">
        <div id="upload-section">
            <div class="upload-box">
                <h1>Spotify Stats Analyzer</h1>
                <p>Export your "Extended streaming history" from your Spotify account settings, and upload the .zip file
                    here to analyze your listening habits.</p>
                <input type="file" id="zip-input" accept=".zip" class="hidden">
                <button id="upload-button"><span>‚¨ÜÔ∏è</span> Upload Spotify ZIP</button>
            </div>
        </div>

        <div id="dashboard-section" class="hidden">
            <header>
                <h1>Your Listening Analysis</h1>
                <div class="global-controls">
                    <div class="filter-controls">
                        <label for="date-from">From:</label>
                        <input type="date" id="date-from">
                        <label for="date-to">To:</label>
                        <input type="date" id="date-to">

                        <label for="artist-filter">Artist:</label>
                        <select id="artist-filter">
                            <option value="">All Artists</option>
                        </select>
                        <label for="album-filter">Album:</label>
                        <select id="album-filter">
                            <option value="">All Albums</option>
                        </select>
                        <label for="track-filter">Track:</label>
                        <select id="track-filter">
                            <option value="">All Tracks</option>
                        </select>



                        <button id="apply-filter-btn">Apply</button>
                    </div>
                </div>
                <nav class="tab-nav">
                    <button class="tab-link active" data-tab="overview-tab">üìä Overview</button>
                    <button class="tab-link" data-tab="trends-tab">üìà Trends</button>
                    <button class="tab-link" data-tab="wrapped-tab">üéâ Your Wrapped</button>
                    <button class="tab-link" data-tab="game-tab">üéÆ The Game</button>
                    <button class="tab-link" data-tab="explorer-tab">üîç Data Explorer</button>
                    <button class="tab-link" data-tab="podcast-tab">üéôÔ∏è Podcasts</button>
                </nav>
            </header>

            <main>
                <!-- PESTA√ëA 1: OVERVIEW -->
                <div id="overview-tab" class="tab-content active">
                    <div id="kpi-grid" class="summary-grid"></div>
                    <div id="advanced-kpi-grid" class="summary-grid"></div>
                    <div class="charts-grid">
                        <div class="chart-container full-width">
                            <h3>Listening Timeline (Minutes per Day)</h3>
                            <div class="time-agg-controls">
                                <button class="time-agg-btn" data-unit="day">Daily</button>
                                <button class="time-agg-btn active" data-unit="week">Weekly</button>
                                <button class="time-agg-btn" data-unit="month">Monthly</button>
                                <button class="time-agg-btn" data-unit="year">Yearly</button>
                            </div>
                            <div class="chart-wrapper"><canvas id="timeline-chart"></canvas></div>
                        </div>
                        <div class="chart-container">
                            <h3>Top 5 Tracks</h3>
                            <div id="top-tracks-table" class="top-items-table"></div>
                        </div>
                        <div class="chart-container">
                            <h3>Top 5 Artists</h3>
                            <div id="top-artists-table" class="top-items-table"></div>
                        </div>
                        <div class="chart-container">
                            <h3>Top 5 Albums</h3>
                            <div id="top-albums-table" class="top-items-table"></div>
                        </div>
                    </div>
                </div>

                <!-- PESTA√ëA 2: TRENDS -->
                <div id="trends-tab" class="tab-content">
                    <div class="charts-grid">
                        <div class="chart-container">
                            <h3>Listening by Platform</h3>
                            <div class="chart-wrapper"><canvas id="platform-chart"></canvas></div>
                        </div>
                        <div class="chart-container">
                            <h3>Listening by Country</h3>
                            <div class="chart-wrapper"><canvas id="country-chart"></canvas></div>
                        </div>
                        <div class="chart-container">
                            <h3>How You Start a Song</h3>
                            <div class="chart-wrapper"><canvas id="reason-start-chart"></canvas></div>
                        </div>
                        <div class="chart-container">
                            <h3>Listening Clock (Hour of Day)</h3>
                            <div class="chart-wrapper"><canvas id="listening-clock-chart"></canvas></div>
                        </div>
                        <div class="chart-container">
                            <h3>Listening by Day of Week</h3>
                            <div class="chart-wrapper"><canvas id="day-of-week-chart"></canvas></div>
                        </div>
                        <div class="chart-container">
                            <h3>Listening by Month</h3>
                            <div class="chart-wrapper"><canvas id="monthly-listening-chart"></canvas></div>
                        </div>
                    </div>
                </div>

                <!-- PESTA√ëA 3: YOUR WRAPPED -->
                <div id="wrapped-tab" class="tab-content">
                    <div class="wrapped-header">
                        <h2>Your Listening Wrapped</h2>
                        <div class="filter-controls">
                            <label for="wrapped-year-filter">Select Year:</label>
                            <select id="wrapped-year-filter"></select>
                        </div>
                    </div>
                    <div id="wrapped-content" class="wrapped-grid"></div>
                </div>

                <!-- PESTA√ëA 4: THE GAME -->
                <div id="game-tab" class="tab-content">
                    <div id="game-container" class="game-container"></div>
                </div>

                <!-- PESTA√ëA 5: DATA EXPLORER -->
                <div id="explorer-tab" class="tab-content">
                    <div class="charts-grid">
                        <div class="chart-container">
                            <h3>Track Name Word Cloud</h3>
                            <div id="word-cloud-container" class="word-cloud-container">
                                <canvas id="word-cloud-canvas"></canvas>
                            </div>
                        </div>
                        <div class="chart-container full-width">
                            <h3>Full Streaming History</h3>
                            <div class="table-container">
                                <table id="data-table" class="df-table"></table>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- PESTA√ëA 6: PODCASTS -->
        <div id="podcast-tab" class="tab-content">
            <div class="charts-grid">
                <div class="chart-container">
                    <h3>Top Podcast Shows</h3>
                    <canvas id="podcast-shows-chart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Top Podcast Episodes</h3>
                    <canvas id="podcast-episodes-chart"></canvas>
                </div>
                <div class="chart-container full-width">
                    <h3>Podcast Listening Timeline</h3>
                    <canvas id="podcast-daily-chart"></canvas>
                </div>
            </div>
        </div>

        <div id="loading-overlay" class="hidden">
            <div class="spinner"></div>
            <p id="loading-message">Processing your data...</p>
        </div>
    </div>

    <script type="module" src="js/main.js"></script>
</body>

</html>